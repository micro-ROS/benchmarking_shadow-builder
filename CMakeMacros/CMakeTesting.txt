function(create_tests MODULE_NAME SOURCES_FILES TESTS_MODULE_SRC)
	if (${ENABLE_TESTS}) 
		add_library(${MODULE_NAME}_test SHARED ${SOURCES_FILES})

		foreach (TEST_SRC ${TESTS_MODULE_SRC})
			get_filename_component(BARENAME ${TEST_SRC} NAME)	
			string(REPLACE ".cpp" "" TEST_MODULE_EXE ${BARENAME})
			message(STATUS "Building ${TEST_MODULE_EXE}")
			add_executable(${TEST_MODULE_EXE}_test ${TEST_SRC})
			target_link_libraries(${TEST_MODULE_EXE}_test ${MODULE_NAME}_test)
			add_test(${TEST_MODULE_EXE}_tests ${MODULE_NAME}Tests)
		endforeach()
	endif()
endfunction()

function(create_link_tests MODULE_NAME LINK_FILES)
	if (${ENABLE_TESTS}) 
		target_link_libraries(${MODULE_NAME}_test ${LINK_FILES})
	endif()
endfunction()
